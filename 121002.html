<!DOCTYPE html><html><head><meta charset='utf-8'><meta http-equiv='Access-Control-Allow-Origin' content='*'><meta http-equiv='Access-Control-Allow-Credentials' content='true'><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/marked.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/gameelements.js'></script><link rel='stylesheet' href='https://fustyles.github.io/webduino/SpBlocklyJS/css/icon_custom.css' /><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/spreadsheetsql.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/loader.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/chart_20220723/Chart.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/chart_20220723/barchart.js'></script></head><body>
<script>
const delay = (seconds) => {
    return new Promise((resolve) => {
        setTimeout(resolve, seconds * 1000);
    });
};
const main = async () => {
    function spreadsheetsql_QueryResponse_2(res) {
        spreadsheetsql_QueryResponse(res, "2");
    }
    window.spreadsheetsql_QueryResponse_2 = spreadsheetsql_QueryResponse_2;

    async function spreadsheetsql_getDataFinish_2(head_response, response) {
        text_create('2', 120, 30, 700, 100, '#ffffff', '#000000', 30, 1, (spreadsheetsql_getCell(1, 1, "2")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_2 = spreadsheetsql_getDataFinish_2;

    // 描述此函式...
    function light_CO2() {
        spreadsheetsql_settings('1ZW_b2LHUNwkLgjNMLa8QWBTn5kbAXwNDrofR6Vz2u-c', 'light_time', "2");
        spreadsheetsql_executeSql('select E limit 1 offset 0', "2");
    }

    function spreadsheetsql_QueryResponse_1(res) {
        spreadsheetsql_QueryResponse(res, "1");
    }
    window.spreadsheetsql_QueryResponse_1 = spreadsheetsql_QueryResponse_1;

    async function spreadsheetsql_getDataFinish_1(head_response, response) {
        text_create('1', 100, 30, 400, 100, '#ffffff', '#000000', 30, 1, (spreadsheetsql_getCell(1, 1, "1")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_1 = spreadsheetsql_getDataFinish_1;

    // 描述此函式...
    function light_time() {
        spreadsheetsql_settings('1ZW_b2LHUNwkLgjNMLa8QWBTn5kbAXwNDrofR6Vz2u-c', 'light_time', "1");
        spreadsheetsql_executeSql('select D limit 1 offset 0', "1");
    }

    function spreadsheetsql_QueryResponse_3(res) {
        spreadsheetsql_QueryResponse(res, "3");
    }
    window.spreadsheetsql_QueryResponse_3 = spreadsheetsql_QueryResponse_3;

    async function spreadsheetsql_getDataFinish_3(head_response, response) {
        text_create('3', 120, 30, 700, 250, '#ffffff', '#000000', 30, 1, (spreadsheetsql_getCell(1, 1, "3")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_3 = spreadsheetsql_getDataFinish_3;

    // 描述此函式...
    function cold_CO2() {
        spreadsheetsql_settings('1ZW_b2LHUNwkLgjNMLa8QWBTn5kbAXwNDrofR6Vz2u-c', 'cold_time', "3");
        spreadsheetsql_executeSql('select E limit 1 offset 0', "3");
    }

    function spreadsheetsql_QueryResponse_4(res) {
        spreadsheetsql_QueryResponse(res, "4");
    }
    window.spreadsheetsql_QueryResponse_4 = spreadsheetsql_QueryResponse_4;

    async function spreadsheetsql_getDataFinish_4(head_response, response) {
        text_create('4', 100, 30, 400, 250, '#ffffff', '#000000', 30, 1, (spreadsheetsql_getCell(1, 1, "4")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_4 = spreadsheetsql_getDataFinish_4;

    // 描述此函式...
    function cold_time() {
        spreadsheetsql_settings('1ZW_b2LHUNwkLgjNMLa8QWBTn5kbAXwNDrofR6Vz2u-c', 'cold_time', "4");
        spreadsheetsql_executeSql('select D limit 1 offset 0', "4");
    }

    function spreadsheetsql_QueryResponse_5(res) {
        spreadsheetsql_QueryResponse(res, "5");
    }
    window.spreadsheetsql_QueryResponse_5 = spreadsheetsql_QueryResponse_5;

    async function spreadsheetsql_getDataFinish_5(head_response, response) {
        text_create('5', 120, 30, 700, 400, '#ffffff', '#000000', 30, 1, (spreadsheetsql_getCell(1, 1, "5")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_5 = spreadsheetsql_getDataFinish_5;

    // 描述此函式...
    function count_all() {
        spreadsheetsql_settings('1ZW_b2LHUNwkLgjNMLa8QWBTn5kbAXwNDrofR6Vz2u-c', 'count_all', "5");
        spreadsheetsql_executeSql('select A limit 1 offset 0', "5");
    }


    head_add_viewport(1, 1, 2, "yes");
    span_create('1', 200, 0, 30, '電器', 999);
    span_create('4', 200, 100, 30, '電燈', 999);
    span_create('5', 200, 250, 30, '冷氣', 999);
    span_create('2', 400, 0, 30, '目前使用時間', 999);
    span_create('3', 700, 0, 30, '碳排放量(Kg_CO2e)', 999);
    span_create('6', 200, 400, 30, '碳排放合計', 999);
    light_time();
    light_CO2();
    cold_time();
    cold_CO2();
    count_all();
    var config = {
        id: '',
        type: "bar",
        data: {
            labels: [],
            datasets: [{
                label: '電燈',
                data: [],
                borderColor: '#ff0000',
                backgroundColor: '#ff0000'
            }, {
                label: '冷氣',
                data: [],
                borderColor: '#0000ff',
                backgroundColor: '#0000ff'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: "top",
                },
                title: {
                    display: true,
                    text: '教室設備用電量'
                }
            },
            scales: {
                yAxes: {
                    title: {
                        display: true,
                        text: '時間',
                    },
                    ticks: {
                        precision: 0
                    }
                },
                xAxes: {
                    title: {
                        display: true,
                        text: '設備',
                    }
                }
            }
        },
        width: 600,
        height: 400,
        left: 1000,
        top: 100,
        count: 10
    };
    barchart(config);
    while (true) {
        await delay(1);
        barchart({
            id: '',
            clear: ""
        });
        barchart({
            id: '',
            data: ['', text_get('1', "value"), text_get('4', "value")]
        });
        cold_time();
        light_time();
        if ((text_get('4', "value")) >= 3) {
            span_create('7', 200, 500, 50, '冷氣建議:若體感溫度無達到開啟冷氣的需求,可以先保持通風。', 999);
        }
        if ((text_get('1', "value")) >= 30) {
            span_create('8', 200, 580, 50, '電燈建議:全班不在教室時,請隨手關燈。', 999);
        }
    }
};
main();
</script>
</body></html>